This repository contains the python code that generated the figures in the publication "Complete representation of action space and value in all striatal pathways", available on [bioRxiv](https://www.biorxiv.org/content/10.1101/2020.03.29.983825v1). The associated data files can be found [here](https://doi.org/10.5281/zenodo.5029598).

- `endoData_2019.hdf` includes the [CaImAn](https://github.com/flatironinstitute/CaImAn)-extracted calcium traces and behavioral data (operant chamber logs, [DeepLabCut](https://github.com/DeepLabCut/DeepLabCut)-tracked coordinates).
- `alignment_190227.hdf` includes ROI-mappings across days as well as the ROI spatial filters as images.


### How to recreate our figures

Create an isolated python environment and install the required packages using [conda](https://docs.anaconda.com/anaconda/install/).

```bash
$ conda create -n striatum-2choice python=3.8.3
$ conda activate striatum-2choice
$ conda install -c conda-forge cython numpy pandas scipy scikit-learn statsmodels h5py \
  tqdm scikit-image pillow matplotlib seaborn deprecated pytables opencv pims pip
$ pip install cmocean figurefirst
```

Git-clone the repository or download it as a zip file and unpack.

```bash
git clone https://github.com/wegmor/striatum-2choice.git
```

Navigate to the top of the repository folder structure and create a `data` subfolder.
Copy the data files `endoData_2019.hdf` and `alignment_190227.hdf` into the `data` folder.

Each figure is generated by its own python script. The figures will be saved to a subfolder `svg`.
Many of the figures require substantial, preparatory computation (12+ hours, e.g. due to 1,000 bootstrapping steps); the results of this preprocessing are stored in a `cache` folder as pickle files.

To generate any figure, activate the conda environment (`$ conda activate striatum-2choice`), navigate to the top of the repository folder structure, and run the associated python script (`$ python figureX.py`). Each figure is created by its one python script, with a name starting with `figure` followed by the figure number.

### Reference

Weglage, M., WÃ¤rnberg, E., Lazaridis, I., Tzortzi, O., & Meletis, K. (2020). *Complete representation of action space and value in all striatal pathways.* bioRxiv, 2020.03.29.983825. https://doi.org/10.1101/2020.03.29.983825
